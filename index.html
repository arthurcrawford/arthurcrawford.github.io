<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.18.1" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title> a4 Pizza &middot; a4 Pizza </title>

  
  <link rel="stylesheet" href="http://a4pizza.com/css/poole.css">
  <link rel="stylesheet" href="http://a4pizza.com/css/syntax.css">
  <link rel="stylesheet" href="http://a4pizza.com/css/hyde.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  <link href="http://a4pizza.com/index.xml" rel="alternate" type="application/rss+xml" title="a4 Pizza" />

  
  <link rel="stylesheet" href="https://yandex.st/highlightjs/8.0/styles/default.min.css">
  <script src="https://yandex.st/highlightjs/8.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

</head>

<body class="">

<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="http://a4pizza.com/"><h1>a4 Pizza</h1></a>
      <p class="lead">
       Words of wisdom 
      </p>
    </div>

    <ul class="sidebar-nav">
      <li><a href="/">Home</a> </li>
      
        <li><a href="/post/aptly/"> Aptly </a></li>
      
        <li><a href="/post/simplestdeb/"> Simplest .deb </a></li>
      
        <li><a href="/post/second/"> second </a></li>
      
        <li><a href="/post/third/"> third </a></li>
      
    </ul>

    <p>&copy; 2017. All rights reserved. </p>
  </div>
</div>


    <div class="content container">
<div class="posts">

      
  <div class="post">
    <h1 class="post-title">
      <a href="http://a4pizza.com/post/simplestdeb/">
        Simplest .deb
      </a>
    </h1>

    <span class="post-date">Tue, Jan 26, 2016</span>

    <p>We are to build a package called <code>package-a</code>.
Let&rsquo;s examine the source code tree.</p>

<pre><code class="language-bash"># tree package-a
package-a
|-- DEBIAN
|   `-- control
`-- usr
    `-- bin
        `-- package-a
</code></pre>

<p>The source contains our &ldquo;application&rdquo;, simply an executable shell script, also called <code>package-a</code>, although there is no significance in using the same name for both the executable and the Debian package.  Note, though, that the relative path of the executable in the source tree reflects its intended destination when installed - i.e. <code>/usr/bin</code>.</p>

<p>To build this package we can use the tool <code>dpkg</code>.</p>

<pre><code># dpkg --build package-a build
</code></pre>

<p>You might also see the equivalent:</p>

<pre><code># dpkg-deb --build package-a build
</code></pre>

<p>A quick look at the manpage for <code>dpkg</code> will reveal that it simply delegates some of its capabilities to lower level tools - hence the alternative form.</p>

<p>In either case, the <code>--build</code> option takes a single argument - the source directory (<code>package-a/</code>).  The second positional argument is the target directory into which the archive is built (<code>build/</code>).</p>

<p>You may be interested to see what&rsquo;s actually in the built package.  Since a Debian package is an <code>ar</code> format archive, you can look inside using the <code>ar</code> tool.</p>

<pre><code># ar t build/package-a_1.0.0_all.deb
debian-binary
control.tar.gz
data.tar.xz
</code></pre>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://a4pizza.com/post/aptly/">
        Aptly
      </a>
    </h1>

    <span class="post-date">Mon, Jan 11, 2016</span>

    <p>This document serves as a quick primer on using Aptly and working with Debian package repositories as part of your software development lifecycle.</p>

<p>To help easily work through some of the concepts there is a Dockerfile <a href="https://github.com/arthurcrawford/deb-build">here</a> that will help set you up with what you need.</p>

<p>Running a conatiner to test Aptly.</p>

<pre><code>$ git clone https://github.com/arthurcrawford/deb-build.git
$ cd deb-build
$ docker build -t deb-build . 
$ docker run -ti -p 8080:8080 deb-build bash
</code></pre>

<p>Installing Aptly on Mac.</p>

<pre><code>$ brew install aptly
</code></pre>

<p>Creating a repo.</p>

<pre><code>$ aptly repo create -distribution=test -component=main acme-test
</code></pre>

<p>Listing repos.</p>

<pre><code>$ aptly repo list

List of local repos:
* [acme-test] (packages: 0)

To get more information about local repository, run `aptly repo show &lt;name&gt;`.
</code></pre>

<p>The configuration.</p>

<pre><code>$ cat  ~/.aptly.conf 
</code></pre>

<p>Publishing (to local file system for testing only)</p>

<pre><code>$ aptly -architectures=amd64 publish repo --skip-signing=true acme-test
</code></pre>

<p>In the above, we need to specify the architecture.  For example, to determine what this is on your target system:</p>

<pre><code>$ dpkg --print-architecture
amd64    
</code></pre>

<p>Also, in the example we have used the option <code>--skip-signing=true</code> which we wouldn&rsquo;t normally want to do.</p>

<p>Serve over embedded HTTP server.</p>

<pre><code>$ aptly serve
</code></pre>

<p>Test that aptly&rsquo;s local embedded server is available:</p>

<pre><code>$ curl http://192.168.99.100:8080/    
</code></pre>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://a4pizza.com/post/third/">
        third
      </a>
    </h1>

    <span class="post-date">Thu, Jan 7, 2016</span>

    
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://a4pizza.com/post/second/">
        second
      </a>
    </h1>

    <span class="post-date">Thu, Jan 7, 2016</span>

    
  </div>
  
</div>
</div>

  </body>
</html>
